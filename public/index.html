<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Force Bits | Physics Tests</title><link rel="stylesheet" href="styles/main.css?v=3"></head><body><canvas id="canvas"></canvas><div class="slider-container"><span><span>No Move: <input id="nomove" type="checkbox"> </span><button id="4z">4 Zones</button> <button id="6z">6 Zones</button> <button id="8z">8 Zones</button> <button id="10z">10 Zones</button></span></div><p id="cput">CPU Time:</p><script defer="defer">(()=>{"use strict";var t={545:function(t,e,s){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=s(6),n=s(147),r=o(s(938)),a=o(s(725)),l=document.querySelector("canvas"),h=document.getElementById("cput"),c=document.getElementById("nomove"),u=i.SimManager.init(l,!1),d=u.userInput,f=u.ctx;let m=new n.Vec2,p=0,y=0,w=0,_=0,x=0,v=[],g=new a.default(f,l.width/2,l.height/2);function M(t){v=[],g=new a.default(f,l.width/2,l.height/2,t)}u.resizeListeners.push((()=>{g.pos=new n.Vec2(l.width/2,l.height/2)})),d.downListeners.push((t=>{m=new n.Vec2(t.offsetX,t.offsetY)})),d.upListeners.push((t=>{if(!d.lmbDown)return;const e=d.mousePos.sub(m).normalize(),s=new r.default(f,m.x,m.y,e,"ERB");v.push(s)})),function t(){requestAnimationFrame(t);const e=performance.now();if(performance.now()-x>=30){x=performance.now(),function(){c.checked||(g.pos=g.pos.add(g.vel.mul(5)));for(let t=0;t<v.length;t++){const e=v[t];if(!e.visible)continue;let s=e.pos.add(e.vel.mul(5));const o=s.x>l.width||s.x<0,i=s.y>l.height||s.y<0;if(o||i)v.splice(t,1);else if(e.pos=s,e.pos.distance(g.pos)<=r.default.radius+a.default.radius){const t=e.vel.mul(-1);let s=[-1,0];for(let e=0;e<g.zoneCount;e++){const o=g.zones[e][0];if(o.dot(t)>=0){const i=o.angleBetween(t);(-1===s[0]||Math.abs(i)<Math.abs(s[1]))&&(s=[e,i])}}const o=g.zones[s[0]],i=g.zones[(s[0]+g.zoneCount/2)%g.zoneCount];if(g.rot+=s[1]/(g.mass-9),y=s[1]/Math.abs(s[1]),p=performance.now(),i[1].length>0){e.vel=o[0],e.pos=g.pos.add(o[0].mul(a.default.radius+r.default.radius+5));const t=i[1].splice(-1,1)[0];g.mass-=1,t.visible=!0,t.pos=g.pos.add(i[0].mul(a.default.radius+r.default.radius+5)),t.vel=i[0]}else e.visible=!1,o[1].push(e),g.mass+=1,console.log(g.vel.mag);g.calcVel()}}}();const t=u.userInput.mousePos;f.clearRect(0,0,l.width,l.height),0!==y&&(f.fillStyle="#39e630",f.strokeStyle="#39e630",f.beginPath(),f.arc(g.pos.x+a.default.radius*-y,g.pos.y-(a.default.radius+20),r.default.radius,0,2*Math.PI),f.closePath(),f.fill(),f.beginPath(),f.moveTo(g.pos.x+a.default.radius,g.pos.y-(a.default.radius+20)),f.lineTo(g.pos.x-a.default.radius,g.pos.y-(a.default.radius+20)),f.closePath(),f.stroke(),performance.now()-p>2e3&&(y=0));for(const t of v)t.visible&&t.draw();if(g.draw(),g.mass>10){const t=g.velNorm.mul(a.default.radius),e=g.velNorm.mul(2*a.default.radius);f.beginPath(),f.moveTo(g.pos.x+t.x,g.pos.y+t.y),f.lineTo(g.pos.x+e.x,g.pos.y+e.y),f.closePath(),f.stroke()}let e=t;d.lmbDown&&(e=m,f.lineWidth=2,f.strokeStyle="#2f54f7",f.beginPath(),f.moveTo(m.x,m.y),f.lineTo(t.x,t.y),f.closePath(),f.stroke()),f.fillStyle="#2f54f7",f.beginPath(),f.arc(e.x,e.y,r.default.radius,0,2*Math.PI),f.closePath(),f.fill()}const s=performance.now()-e;if(w++,_+=s,w>=30){const t=_/w;w=0,_=0,h.innerText=`CPU Time: ${t.toFixed(2)}ms`}}(),document.getElementById("4z").onclick=()=>M(4),document.getElementById("6z").onclick=()=>M(6),document.getElementById("8z").onclick=()=>M(8),document.getElementById("10z").onclick=()=>M(10),c.onchange=()=>{c.checked&&(g.pos=new n.Vec2(l.width/2,l.height/2))}},725:function(t,e,s){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=s(147),n=o(s(906));class r extends n.default{constructor(t,e,s,o=4){super(t,r.radius,e,s),this.mass=10,this.zones=[],this.velNorm=new i.Vec2,this._rot=0,this.zoneCount=o,this.calcZones(!0)}get rot(){return this._rot}set rot(t){this._rot=t%(2*Math.PI),this.calcZones()}calcZones(t=!1){for(let e=0;e<this.zoneCount;e++){const s=(this._rot+e*Math.PI*2/this.zoneCount)%(2*Math.PI);t?this.zones[e]=[i.Vec2.fromAngle(s),[]]:this.zones[e][0]=i.Vec2.fromAngle(s)}}calcVel(){let t=new i.Vec2;for(const e of this.zones)for(const s of e[1]){const s=e[0].mul(-1);t=t.add(s.mul(1/this.mass))}const e=t.normalize();this.velNorm=e,t.mag>1?this.vel=e:this.vel=t}draw(){const t=this.ctx;t.strokeStyle="#2f54f7",t.fillStyle="#000",t.lineWidth=2,t.save(),t.translate(this.pos.x,this.pos.y),t.beginPath(),t.arc(0,0,r.radius,0,2*Math.PI),t.closePath(),t.fill(),t.stroke(),t.textAlign="center",t.textBaseline="middle",t.font="bold 20px Arial",t.fillStyle="#FFF";for(let e=0;e<this.zoneCount;e++){const s=this.zones[e],o=s[0],i=s[1];t.beginPath(),t.moveTo(0,0),t.lineTo(o.x*r.radius,o.y*r.radius),t.closePath(),t.stroke(),t.fillText(i.length.toString(),o.x*r.radius,o.y*r.radius),t.fillText((e+1).toString(),o.x*(r.radius/2),o.y*(r.radius/2))}t.restore()}}e.default=r,r.radius=60},938:function(t,e,s){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(s(906));class n extends i.default{constructor(t,e,s,o,i){super(t,n.radius,e,s,o.normalize().mul(1)),this.color=[0,0,0],this.visible=!0,this.fillStyle="",this.polarity=i,this.color="ERB"===i?[.2157,.3921,1]:[1,.2588,.2588],this.fillStyle=`rgb(${255*this.color[0]}, ${255*this.color[1]}, ${255*this.color[2]})`}switchPolarity(){"ERB"===this.polarity?(this.polarity="PRB",this.color=[1,.2588,.2588]):(this.polarity="ERB",this.color=[.2157,.3921,1]),this.fillStyle=`rgb(${255*this.color[0]}, ${255*this.color[1]}, ${255*this.color[2]})`}draw(){const t=this.ctx;t.fillStyle=this.fillStyle,t.beginPath(),t.arc(this.pos.x,this.pos.y,n.radius,0,2*Math.PI),t.closePath(),t.fill()}}e.default=n,n.radius=6},906:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0});const o=s(147);e.default=class{constructor(t,e,s,i,n=new o.Vec2){this.pos=new o.Vec2(s,i),this.vel=n,this.ctx=t}}},6:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SimManager=void 0;const o=s(293);class i{constructor(t,e){this.physicsInterval=10,this.resizeListeners=[],this.canvas=t,e?this.gl=t.getContext("webgl2"):this.ctx=t.getContext("2d"),t.addEventListener("contextmenu",(t=>{t.preventDefault()})),window.addEventListener("resize",(()=>{this.resize(),this.resizeListeners.forEach((t=>t()))})),this.userInput=new o.UserInput(t),this.resize()}resize(){const{innerWidth:t,innerHeight:e}=window;this.canvas.width=t,this.canvas.height=e}static init(t,e){return i._instance||(i._instance=new i(t,e)),i._instance}static instance(){return i._instance}}e.SimManager=i},293:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.UserInput=void 0;const o=s(147);e.UserInput=class{constructor(t){this.mousePos=new o.Vec2,this.lmbDown=!1,this.rmbDown=!1,this.downListeners=[],this.upListeners=[],this.scrollListeners=[],t.addEventListener("wheel",(t=>{for(const e of this.scrollListeners)e(t.deltaY/Math.abs(t.deltaY))})),t.addEventListener("mousemove",(t=>{this.mousePos=new o.Vec2(t.offsetX,t.offsetY)})),t.addEventListener("mousedown",(t=>{switch(t.button){case 0:this.lmbDown=!0;break;case 2:this.rmbDown=!0}for(const e of this.downListeners)e(t)})),t.addEventListener("mouseup",(t=>{for(const e of this.upListeners)e(t);switch(t.button){case 0:this.lmbDown=!1;break;case 2:this.rmbDown=!1}})),t.addEventListener("mouseout",(t=>{this.lmbDown=!1,this.rmbDown=!1}))}}},722:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.randFloat=e.randInt=e.degreesToRadians=e.radiansToDegrees=void 0,e.radiansToDegrees=t=>180*t/Math.PI,e.degreesToRadians=t=>t*Math.PI/180,e.randInt=(t,e)=>Math.floor(Math.random()*(e-t+1)+t),e.randFloat=(t,e)=>Math.random()*(e-t)+t},147:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Color=e.Vec2=void 0;const o=s(722);class i{constructor(t=0,e=0){this._x=t,this._y=e}add(t){return new i(this._x+t.x,this._y+t.y)}sub(t){return new i(this._x-t.x,this._y-t.y)}mul(t){return new i(this._x*t,this._y*t)}div(t){return new i(this._x/t.x,this._y/t.y)}normalize(){const t=Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2));return new i(this._x/t,this._y/t)}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}distance(t){const e=this._x-t.x,s=this._y-t.y;return Math.sqrt(Math.pow(e,2)+Math.pow(s,2))}direction(t){return this.sub(t).normalize()}rotate(t){return new i(this._x*Math.cos(t)-this._y*Math.sin(t),this._x*Math.sin(t)+this._y*Math.cos(t))}angleBetween(t){return Math.atan2(t.y*this._x-t.x*this._y,t.x*this._x+t.y*this._y)}toAngle(){return Math.atan2(this._y,this._x)}copy(){return new i(this._x,this._y)}surfaceNorm(){return new i(-this._y,this._x)}static random(t,e,s,n){return new i((0,o.randFloat)(t,e),(0,o.randFloat)(s,n))}static fromAngle(t){return new i(Math.cos(t),Math.sin(t))}get mag(){return Math.sqrt(Math.pow(this._x,2)+Math.pow(this._y,2))}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}}e.Vec2=i,e.Color=class{constructor(t=0,e=0,s=0){this.h=t,this.s=e,this.l=s}}}},e={};!function s(o){var i=e[o];if(void 0!==i)return i.exports;var n=e[o]={exports:{}};return t[o].call(n.exports,n,n.exports,s),n.exports}(545)})();</script></body></html>